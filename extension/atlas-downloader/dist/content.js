(function(){"use strict";const _t=new Set(["co.uk","org.uk","ac.uk","gov.uk","com.au","net.au","org.au","edu.au","gov.au","co.nz","org.nz","ac.nz","co.jp","or.jp","ne.jp","co.kr","com.br","com.mx"]);function vt(q){const U=(q||"").trim().toLowerCase();if(!U)return"";const S=U.split(".").filter(Boolean);if(S.length<=2)return U;const I=S.slice(-2).join("."),j=S.slice(-3).join(".");return _t.has(I)&&S.length>=3?j:I}function Ct(q){const U=(q||"").trim();if(!U)return"";try{const S=new URL(U).hostname;return vt(S)}catch{return""}}(()=>{const S="atlas-downloader-root",I="atlas-open",j=(()=>{try{return window.top===window.self}catch{return!1}})(),rt=(()=>{try{return chrome.runtime.getManifest?.().version??""}catch{return""}})();let ot=null;const st="http://www.w3.org/2000/svg",kt=e=>{const n=document.createElementNS(st,"svg");n.setAttribute("viewBox","0 0 24 24"),n.setAttribute("aria-hidden","true"),n.setAttribute("fill","none"),n.setAttribute("stroke-width","2"),n.setAttribute("stroke-linecap","round"),n.setAttribute("stroke-linejoin","round"),n.setAttribute("width","18"),n.setAttribute("height","18"),n.setAttribute("style","color: #e2e8f0; stroke: currentColor; fill: none;");for(const o of e){const a=document.createElementNS(st,"path");a.setAttribute("d",o),a.setAttribute("fill","none"),a.setAttribute("stroke","currentColor"),a.setAttribute("stroke-width","2"),a.setAttribute("stroke-linecap","round"),a.setAttribute("stroke-linejoin","round"),n.appendChild(a)}return n},St=[{type:"love",label:"Favorite",className:"love",pathDs:["M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78Z"]},{type:"like",label:"Like",className:"like",pathDs:["M7 10v12","M15 5.88 14 10h6.14a2 2 0 0 1 1.94 2.46l-2.34 8.25A2 2 0 0 1 17.82 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.34a2 2 0 0 0 1.79-1.11l3.07-5.89A2 2 0 0 1 15 2a2 2 0 0 1 2 2v1.88Z"]},{type:"dislike",label:"Dislike",className:"dislike",pathDs:["M17 14V2","M9 18.12 10 14H3.86a2 2 0 0 1-1.94-2.46L4.26 3.29A2 2 0 0 1 6.18 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.34a2 2 0 0 0-1.79 1.11l-3.07 5.89A2 2 0 0 1 9 22a2 2 0 0 1-2-2v-1.88Z"]},{type:"funny",label:"Funny",className:"funny",pathDs:["M8 14s1.5 2 4 2 4-2 4-2","M9 9h.01","M15 9h.01","M22 12a10 10 0 1 1-20 0 10 10 0 0 1 20 0Z"]}];function L(e,n){const o=typeof e=="string"?e:"";return o.length<=n?o:o.slice(0,n)}function P(e){return Ct(e)||"Extension"}chrome.runtime.onMessage.addListener(e=>{if(!(!e||typeof e!="object"||e.type!=="atlas-open-sheet")&&j)try{chrome.storage.sync.get(["atlasBaseUrl","atlasExcludedDomains"],o=>{const a=tt(o.atlasBaseUrl||"");if(a&&et(window.location.hostname,a))return;const s=ct(o.atlasExcludedDomains||"");dt(window.location.hostname,s)||(lt(),ot?.())})}catch{}}),chrome.storage.sync.get(["atlasBaseUrl","atlasExcludedDomains"],e=>{const n=tt(e.atlasBaseUrl||"");if(n&&et(window.location.hostname,n))return;const o=ct(e.atlasExcludedDomains||"");dt(window.location.hostname,o)||(j?lt():Nt())});function Nt(){if(document.getElementById(S))return;const e=document.createElement("div");e.id=S;const n=e.attachShadow({mode:"closed"}),o=document.createElement("link");o.rel="stylesheet",o.href=chrome.runtime.getURL("dist/content.css"),n.appendChild(o);const a=document.createElement("div");a.className="atlas-shadow-root";const s=it(a),b=(i,A)=>{try{chrome.runtime.sendMessage(i,A)}catch(c){(()=>{if(c instanceof Error)return c.message;if(c&&typeof c=="object"&&"message"in c){const f=c.message;return typeof f=="string"?f:String(f)}return String(c)})().includes("Extension context invalidated")?s("Atlas extension was reloaded. Refresh this tab."):s("Atlas extension error. Refresh this tab."),A(null)}};n.appendChild(a),(document.body||document.documentElement).appendChild(e),ut({showToast:s,sendMessageSafe:b,isSheetOpen:()=>!1})}function lt(){if(document.getElementById(S))return;const e=document.createElement("div");e.id=S;const n=e.attachShadow({mode:"closed"}),o=document.createElement("link");o.rel="stylesheet",o.href=chrome.runtime.getURL("dist/content.css"),n.appendChild(o);const a=document.createElement("div");a.className="atlas-shadow-root";const s=it(a),b=(t,l)=>{try{chrome.runtime.sendMessage(t,l)}catch(r){(()=>{if(r instanceof Error)return r.message;if(r&&typeof r=="object"&&"message"in r){const u=r.message;return typeof u=="string"?u:String(u)}return String(r)})().includes("Extension context invalidated")?s("Atlas extension was reloaded. Refresh this tab."):s("Atlas extension error. Refresh this tab."),l(null)}},i=document.createElement("button");i.className="atlas-downloader-toggle",i.type="button",i.setAttribute("aria-label","Atlas Downloader"),i.title="Atlas Downloader";const A=document.createElement("img");A.alt="",A.src=chrome.runtime.getURL("icon.svg"),i.appendChild(A);const c=document.createElement("div");c.className="atlas-downloader-overlay";const d=document.createElement("div");d.className="atlas-downloader-modal",d.setAttribute("role","dialog"),d.setAttribute("aria-modal","true"),d.setAttribute("aria-label","Atlas Media Picker");const f=document.createElement("div");f.className="atlas-downloader-header";const v=document.createElement("div");v.className="atlas-downloader-title",v.textContent="Atlas Media Picker";const E=document.createElement("div");E.className="atlas-downloader-version",E.textContent=rt?`v${rt}`:"";const _=document.createElement("button");_.type="button",_.className="atlas-downloader-close",_.setAttribute("aria-label","Close"),_.textContent="x",f.appendChild(v),f.appendChild(E),f.appendChild(_);const y=document.createElement("div");y.className="atlas-downloader-toolbar";const X=$("Rescan",()=>pt()),V=$("Check Atlas",()=>bt(!1));let D=!1,M=null;const F=$("Debug: off",()=>{D=!D,F.textContent=D?"Debug: on":"Debug: off",D?!M&&g.length>0&&(M={url:g[0].url,reactionType:"like"}):M=null,N(),x(T())}),z=$("Select all",()=>gt(!0)),Z=$("Select none",()=>gt(!1)),ft=document.createElement("span");ft.className="spacer";const Q=$("Queue selected",()=>qt(),{primary:!0});y.appendChild(X),y.appendChild(V),y.appendChild(F),y.appendChild(z),y.appendChild(Z),y.appendChild(ft),y.appendChild(Q);const B=document.createElement("div");B.className="atlas-downloader-meta";const W=document.createElement("div");W.className="atlas-downloader-list",d.appendChild(f),d.appendChild(y),d.appendChild(B),d.appendChild(W),a.appendChild(i),a.appendChild(c),a.appendChild(d),n.appendChild(a),(document.body||document.documentElement).appendChild(e);let g=[],K=0;const Ht=!0;let ht=!1;i.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation(),mt()}),c.addEventListener("click",()=>nt()),_.addEventListener("click",()=>nt()),document.addEventListener("keydown",t=>{t.key==="Escape"&&a.classList.contains(I)&&nt()});function mt(){a.classList.add(I),pt()}function nt(){a.classList.remove(I)}ot=mt,ut({showToast:s,sendMessageSafe:b,isSheetOpen:()=>a.classList.contains(I),setHintShown:t=>{ht=t},getHintShown:()=>ht,enabled:Ht});function $(t,l,r){const h=document.createElement("button");return h.type="button",h.className=`atlas-downloader-btn${r?.primary?" primary":""}`,h.textContent=t,h.addEventListener("click",u=>{u.preventDefault(),u.stopPropagation(),l()}),h}function Ut(t){B.textContent=t,Q.disabled=!0,X.disabled=!0,V.disabled=!0,F.disabled=!0,z.disabled=!0,Z.disabled=!0}function x(t){B.textContent=t;const l=g.filter(r=>r.selected).length;Q.disabled=l===0,X.disabled=!1,V.disabled=g.length===0,F.disabled=g.length===0,z.disabled=g.length===0,Z.disabled=g.length===0}function pt(){K+=1;const t=K;g=[],D&&(M=null),W.replaceChildren(),Ut("Scanning this page…"),xt(l=>{K===t&&(B.textContent=`Scanning… ${l.scanned}/${l.total}`)}).then(l=>{K===t&&(g=l.map(r=>({...r,selected:!0,status:"",statusClass:"",atlas:null})),D&&!M&&g.length>0&&(M={url:g[0].url,reactionType:"like"}),N(),x(T()),bt(!0))})}function gt(t){for(const l of g)l.selected=t;N(),x(T())}function N(){if(W.replaceChildren(),g.length===0){const t=document.createElement("div");t.style.padding="10px 12px",t.style.color="#94a3b8",t.style.fontSize="12px",t.textContent="No matching images/videos found.",W.appendChild(t);return}for(const t of g)W.appendChild(It(t))}function It(t){const l=document.createElement("div");l.className=`atlas-downloader-item${t.selected?" selected":""}`;const r=document.createElement("input");r.type="checkbox",r.checked=t.selected,r.addEventListener("change",()=>{t.selected=r.checked,l.classList.toggle("selected",t.selected),x(T())});const h=document.createElement("div");if(h.className="atlas-downloader-preview",t.preview_url){const k=document.createElement("img");k.loading="lazy",k.alt="",k.src=t.preview_url,h.appendChild(k)}const u=document.createElement("div");u.className="atlas-downloader-info";const p=document.createElement("div");p.className="atlas-downloader-kind",p.textContent=t.tag_name;const m=document.createElement("div");m.className="atlas-downloader-url",m.textContent=t.url,m.title=t.url;const w=document.createElement("div");w.className="atlas-downloader-sub",w.textContent=Wt(t);const C=document.createElement("div");C.className="atlas-downloader-reactions";const O=t.atlas?.reaction?.type||null;for(const k of St){const R=document.createElement("button");R.type="button",R.className=`atlas-downloader-reaction-btn ${k.className}${O===k.type?" active":""}${t.reactionPending?" pending":""}`.trim(),R.setAttribute("aria-label",k.label),R.title=k.label,R.replaceChildren(kt(k.pathDs)),R.disabled=!!t.reactionPending,R.addEventListener("click",Et=>{Et.preventDefault(),Et.stopPropagation(),D&&(M={url:t.url,reactionType:k.type},N()),Ot(t,k.type)}),C.appendChild(R)}u.appendChild(p),u.appendChild(m),u.appendChild(w),u.appendChild(C),D&&M?.url===t.url&&u.appendChild(Pt(t,M.reactionType));const at=document.createElement("div"),At=Bt(t);return at.className=`atlas-downloader-status ${At.className}`.trim(),at.textContent=At.text,l.addEventListener("click",k=>{k.target instanceof HTMLInputElement||(D&&(M={url:t.url,reactionType:M?.reactionType??"like"}),t.selected=!t.selected,r.checked=t.selected,l.classList.toggle("selected",t.selected),x(T()))}),l.appendChild(r),l.appendChild(h),l.appendChild(u),l.appendChild(at),l}function wt(t,l){return{type:l,url:t.url,original_url:t.url,referrer_url:window.location.href,page_title:L(document.title,500),tag_name:t.tag_name,width:t.width,height:t.height,alt:L(t.alt||"",500),preview_url:t.preview_url||"",source:P(t.url)}}function yt(t){return{url:t.url,original_url:t.url,referrer_url:window.location.href,page_title:L(document.title,500),tag_name:t.tag_name,width:t.width,height:t.height,alt:L(t.alt||"",500),preview_url:t.preview_url||"",source:P(t.url),reaction_type:"like"}}function Pt(t,l){const r=document.createElement("details");r.className="atlas-downloader-debug",r.open=!0;const h=document.createElement("summary");h.textContent="Debug payload",r.appendChild(h);const u=document.createElement("pre");return u.textContent=JSON.stringify({react:wt(t,l),download:yt(t)},null,2),r.appendChild(u),r}function Wt(t){const l=t.width&&t.height?`${t.width}×${t.height}`:"size unknown",r=$t(t.url);return r?`${l} • ${r}`:l}function $t(t){try{return new URL(t).hostname}catch{return""}}function T(){const t=g.filter(l=>l.selected).length;return`${g.length} found • ${t} selected`}function Bt(t){return t.status?{text:t.status,className:t.statusClass||""}:t.atlas?.downloaded?{text:"Downloaded",className:"ok"}:t.atlas?.exists?{text:"In Atlas",className:""}:{text:"",className:""}}function bt(t){const l=g.map(r=>r.url).filter(Boolean);l.length!==0&&b({type:"atlas-check-batch",urls:l},r=>{if(!r){t||s("Atlas extension did not respond.");return}if(!r.ok){t||s(r.error||"Atlas check failed.");return}const h=Array.isArray(r.data?.results)?r.data.results:[],u=new Map(h.map(w=>[w.url,w]));let p=0,m=0;for(const w of g){const C=u.get(w.url);C&&(w.atlas={exists:!!C.exists,downloaded:!!C.downloaded,file_id:C.file_id??null,reaction:C.reaction??null},C.exists&&(p+=1),C.downloaded&&(m+=1))}N(),x(T()),t||s(`Atlas check: ${m}/${p} downloaded.`)})}function Ot(t,l){t.reactionPending=l,t.status="Reacting…",t.statusClass="",N();const r=wt(t,l);b({type:"atlas-react",payload:r},h=>{if(t.reactionPending=null,!h){t.status="No response",t.statusClass="err",N(),x(T()),s("Atlas extension did not respond.");return}if(!h.ok){t.status=h.error||"Failed",t.statusClass="err",N(),x(T()),s(h.error||"Reaction failed.");return}const u=h.data||null,p=u?.file||null;t.atlas={exists:!!p,downloaded:!!p?.downloaded,file_id:p?.id??null,reaction:u?.reaction??null},t.atlas.exists&&!t.atlas.downloaded&&l!=="dislike"?(t.status="Queued",t.statusClass="queued"):(t.status="",t.statusClass=""),N(),x(T()),t.atlas.exists&&!t.atlas.downloaded&&l!=="dislike"&&J([t.url],0)})}function qt(){const t=g.filter(r=>r.selected);if(t.length===0){s("Select one or more items first.");return}Q.disabled=!0,X.disabled=!0,V.disabled=!0,z.disabled=!0,Z.disabled=!0;for(const r of t)r.status="Sending…",r.statusClass="";N();const l=t.map(r=>yt(r));b({type:"atlas-download-batch",payloads:l},r=>{if(!r){for(const p of t)p.status="No response",p.statusClass="err";N(),x(T()),s("Atlas extension did not respond.");return}const h=Array.isArray(r.results)?r.results:[],u=[];for(let p=0;p<t.length;p+=1){const m=t[p],w=h[p];if(w?.ok){const C=w.data||null,O=C?.file||null;m.atlas={exists:!!O,downloaded:!!O?.downloaded,file_id:O?.id??null},C?.queued?(m.status="Queued",m.statusClass="queued",u.push(m.url)):(m.status="",m.statusClass="")}else m.status=w?.error||"Failed",m.statusClass="err"}N(),x(T()),r.ok?s(`Queued ${t.length} download(s) in Atlas.`):s(r.error||"Some requests failed."),u.length>0&&J(u,0)})}function J(t,l){l>15||setTimeout(()=>{b({type:"atlas-check-batch",urls:t},r=>{if(!r||!r.ok){J(t,l+1);return}const h=Array.isArray(r.data?.results)?r.data.results:[],u=new Map(h.map(m=>[m.url,m]));let p=0;for(const m of g){const w=u.get(m.url);w&&(m.atlas={exists:!!w.exists,downloaded:!!w.downloaded,file_id:w.file_id??null,reaction:w.reaction??null},w.downloaded?m.status==="Queued"&&(m.status="",m.statusClass=""):p+=1)}N(),x(T()),p>0&&J(t,l+1)})},2e3)}}function xt(e){return new Promise(n=>{const o=document.body||document.documentElement,a=Array.from(o.querySelectorAll("img, video")),s=a.length,b=new Set,i=[];let A=0;const c=f=>{if(typeof window.requestIdleCallback=="function"){window.requestIdleCallback(f,{timeout:500});return}setTimeout(()=>f({timeRemaining:()=>25}),0)},d=f=>{const v=typeof f?.timeRemaining=="function"?f.timeRemaining():25;let E=0;for(;A<s&&(E<80||v>5);){const _=a[A];if(_.closest&&_.closest(`#${S}`)){A+=1,E+=1;continue}const y=G(_);y?.url&&!b.has(y.url)&&(b.add(y.url),i.push(y)),A+=1,E+=1}if(e?.({scanned:A,total:s}),A<s){c(d);return}n(i)};c(d)})}function G(e){if(!(e instanceof Element))return null;if(e.tagName==="IMG"){const n=e,o=n.naturalWidth||n.width||n.clientWidth||null,a=n.naturalHeight||n.height||n.clientHeight||null;if(o&&a&&(o<450||a<450))return null;const s=H(n.currentSrc)||H(n.src)||H(n.getAttribute("src"));return s?{tag_name:"img",url:s,preview_url:s,width:o,height:a,alt:n.alt||""}:null}if(e.tagName==="VIDEO"){const n=Tt(e);return n?{tag_name:"video",url:n,preview_url:e.poster||"",width:e.videoWidth||e.clientWidth||null,height:e.videoHeight||e.clientHeight||null,alt:""}:null}return null}function Tt(e){const n=H(e.currentSrc)||H(e.src)||H(e.getAttribute("src"));if(n)return n;const o=e.querySelector("source[src]"),a=o?H(o.src||o.getAttribute("src")):"";if(a)return a;const s=Lt(e);return s||Mt()}function Mt(){const e=['meta[property="og:video"]','meta[property="og:video:url"]','meta[property="og:video:secure_url"]','meta[name="twitter:player:stream"]','meta[name="twitter:player:stream:url"]'];for(const n of e){const a=document.querySelector(n)?.getAttribute("content"),s=H(a||"");if(s)return s}return""}function Lt(e){let n=e,o=0;for(;n&&o<8;){const a=n.getAttribute?.("data-store");if(a){const s=Dt(a),b=Y(s,0);if(b)return b}n=n.parentElement,o+=1}return""}function Dt(e){if(!e)return null;const n=Rt(e);try{return JSON.parse(n)}catch{return null}}function Rt(e){return!e||typeof e!="string"?"":e.replace(/&quot;/g,'"').replace(/&#34;/g,'"').replace(/&amp;/g,"&").replace(/&#38;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")}function Y(e,n){if(!e||n>4)return"";if(typeof e=="string")return e.startsWith("http")?e:"";if(Array.isArray(e)){for(const a of e){const s=Y(a,n+1);if(s)return s}return""}if(typeof e!="object")return"";const o=["hd_src","sd_src","playable_url","playable_url_quality_hd","playable_url_quality_sd"];for(const a of o){const s=e[a];if(typeof s=="string"&&s.startsWith("http"))return s}for(const a of Object.keys(e)){const s=Y(e[a],n+1);if(s)return s}return""}function it(e){return function(o){const a=document.createElement("div");a.className="atlas-downloader-toast",a.textContent=o,e.appendChild(a),requestAnimationFrame(()=>a.classList.add("show")),setTimeout(()=>{a.classList.remove("show"),a.addEventListener("transitionend",()=>a.remove(),{once:!0})},2600)}}function ct(e){return!e||typeof e!="string"?[]:e.split(/[\n,]/g).map(n=>n.trim()).filter(n=>n&&!n.startsWith("#")).map(n=>(n.startsWith("*.")?n.slice(2):n).toLowerCase()).map(n=>tt(n)||n.replace(/^\.+/,"").trim()).filter(Boolean)}function dt(e,n){const o=(e||"").toLowerCase();if(!o)return!1;for(const a of n)if(et(o,a))return!0;return!1}function tt(e){if(!e||typeof e!="string")return"";const n=e.trim();if(!n)return"";const o=/^https?:\/\//i.test(n)?n:`https://${n}`;try{return new URL(o).hostname}catch{return""}}function et(e,n){return!e||!n?!1:e===n||e.endsWith(`.${n}`)}function H(e){if(!e||typeof e!="string")return"";const n=e.trim();if(!n)return"";const o=n.toLowerCase();return o.startsWith("blob:")||o.startsWith("data:")||o.startsWith("chrome-extension:")||o.startsWith("moz-extension:")||o.startsWith("safari-extension:")?"":n}function ut(e){const n=e.enabled??!0,o=e.getHintShown??(()=>!1),a=e.setHintShown??(()=>{}),s=()=>{o()||(a(!0),e.showToast("Hotkeys: Alt+Left=Like, Alt+Middle=Love, Alt+Right=Dislike"))},b=i=>(typeof i.composedPath=="function"?i.composedPath():[]).some(c=>c instanceof HTMLElement&&c.id===S);document.addEventListener("click",i=>{!n||!(i instanceof MouseEvent)||!i.altKey||e.isSheetOpen()||b(i)||!((i.target instanceof Element?i.target:null)?.closest?.("img, video")??null)||(i.preventDefault(),i.stopPropagation(),i.stopImmediatePropagation())},!0),document.addEventListener("mousedown",i=>{if(!n||!(i instanceof MouseEvent)||!i.altKey||e.isSheetOpen()||b(i))return;const c=(i.target instanceof Element?i.target:null)?.closest?.("img, video")??null;if(!c)return;const d=i.button===0?"like":i.button===1?"love":null;if(!d)return;s(),i.preventDefault(),i.stopPropagation(),i.stopImmediatePropagation();const f=G(c);if(!f){if(c instanceof HTMLVideoElement){const E=(c.currentSrc||c.src||"").trim().toLowerCase();if(E.startsWith("blob:")||E.startsWith("data:")){const _={type:d,url:window.location.href,original_url:window.location.href,referrer_url:window.location.href,page_title:L(document.title,500),tag_name:"video",width:c.videoWidth||c.clientWidth||null,height:c.videoHeight||c.clientHeight||null,alt:"",preview_url:c.poster||"",source:P(window.location.href),download_via:"yt-dlp"};e.sendMessageSafe({type:"atlas-react",payload:_},y=>{if(!y||!y.ok){e.showToast(y?.error||"Reaction failed.");return}e.showToast(`Reacted (${d}). Resolving video in Atlas…`)});return}e.showToast("No direct video URL found.");return}e.showToast("No valid media URL found.");return}const v={type:d,url:f.url,original_url:f.url,referrer_url:window.location.href,page_title:L(document.title,500),tag_name:f.tag_name,width:f.width,height:f.height,alt:L(f.alt||"",500),preview_url:f.preview_url||"",source:P(f.url)};e.sendMessageSafe({type:"atlas-react",payload:v},E=>{if(!E||!E.ok){e.showToast(E?.error||"Reaction failed.");return}e.showToast(`Reacted (${d}). Queued download in Atlas.`)})},!0),document.addEventListener("contextmenu",i=>{if(!n||!(i instanceof MouseEvent)||!i.altKey||e.isSheetOpen()||b(i))return;const c=(i.target instanceof Element?i.target:null)?.closest?.("img, video")??null;if(!c)return;s(),i.preventDefault(),i.stopPropagation(),i.stopImmediatePropagation();const d=G(c);if(!d){if(c instanceof HTMLVideoElement){const v=(c.currentSrc||c.src||"").trim().toLowerCase();if(v.startsWith("blob:")||v.startsWith("data:")){const E={type:"dislike",url:window.location.href,original_url:window.location.href,referrer_url:window.location.href,page_title:L(document.title,500),tag_name:"video",width:c.videoWidth||c.clientWidth||null,height:c.videoHeight||c.clientHeight||null,alt:"",preview_url:c.poster||"",source:P(window.location.href),download_via:"yt-dlp"};e.sendMessageSafe({type:"atlas-react",payload:E},_=>{if(!_||!_.ok){e.showToast(_?.error||"Reaction failed.");return}e.showToast("Disliked.")});return}e.showToast("No direct video URL found.");return}e.showToast("No valid media URL found.");return}const f={type:"dislike",url:d.url,original_url:d.url,referrer_url:window.location.href,page_title:L(document.title,500),tag_name:d.tag_name,width:d.width,height:d.height,alt:L(d.alt||"",500),preview_url:d.preview_url||"",source:P(d.url)};e.sendMessageSafe({type:"atlas-react",payload:f},v=>{if(!v||!v.ok){e.showToast(v?.error||"Reaction failed.");return}e.showToast("Disliked.")})},!0)}})()})();
